generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model Comment {
  id               String      @id @default(cuid())
  content          String
  createdAt        DateTime    @default(now()) @map(name: "created_at")
  author           User?       @relation(fields: [authorId], references: [id])
  authorId         String?
  parentComment    Comment?    @relation("CommentToComment", fields: [parentCommentId], references: [id])
  parentCommentId  String?
  childrenComments Comment[]   @relation("CommentToComment")
  mentions         User[]      @relation("mention")
}

model User {
  id              String       @id @default(cuid())
  name            String?      @db.VarChar(255)
  username        String       @unique @db.VarChar(255)
  email           String?      @unique @db.VarChar(255)
  password        String?      @db.VarChar(255)
  createdAt       DateTime     @default(now()) @map(name: "created_at")
  comments        Comment[]
  mentionedBy     Comment[]    @relation("mention")

  @@map(name: "users")
}